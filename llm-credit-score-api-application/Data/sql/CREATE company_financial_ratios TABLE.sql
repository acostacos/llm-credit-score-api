CREATE TABLE company_financial_ratios (
	company_financial_ratio_id INTEGER PRIMARY KEY,
    company_id INTEGER NOT NULL,
    company_name TEXT,
	fiscal_year INTEGER NOT NULL,
    latest_update_date TEXT,
    shareholders_equity REAL,
    cash_and_cash_equivalents REAL,
    total_current_asset REAL,
    total_current_liab REAL,
    long_term_debt REAL,
    short_term_investment REAL,
    other_short_term_liab REAL,
    shares_outstanding REAL,
    current_debt REAL,
    total_asset REAL,
    total_equity REAL,
    total_liab REAL,
    net_income REAL,
    total_revenue REAL,
    inventory REAL,
    investment_in_assets REAL,
    net_debt REAL
);

INSERT INTO company_financial_ratios SELECT 
  CAST((json_extract(value, '$.company_id') || json_extract(value, '$.fiscal_year')) AS INTEGER) as company_financial_ratio_id,
  json_extract(value, '$.company_id'),
  json_extract(value, '$.company_name'),
  json_extract(value, '$.fiscal_year'),
  json_extract(value, '$.latest_update_date'),
  json_extract(value, '$.shareholders_equity'),
  json_extract(value, '$.cash_and_cash_equivalents'),
  json_extract(value, '$.total_current_asset'),
  json_extract(value, '$.total_current_liab'),
  json_extract(value, '$.long_term_debt'),
  json_extract(value, '$.short_term_investment'),
  json_extract(value, '$.other_short_term_liab'),
  json_extract(value, '$.shares_outstanding'),
  json_extract(value, '$.current_debt'),
  json_extract(value, '$.total_asset'),
  json_extract(value, '$.total_equity'),
  json_extract(value, '$.total_liab'),
  json_extract(value, '$.net_income'),
  json_extract(value, '$.total_revenue'),
  json_extract(value, '$.inventory'),
  json_extract(value, '$.investment_in_assets'),
  json_extract(value, '$.net_debt')
FROM json_each(readfile('../json/company_financial_ratios.json'));
